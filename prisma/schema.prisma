datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


generator client {
  provider = "prisma-client-js"
}

model User {
  id               String        @id @default(cuid())
  clerkId          String        @unique
  email            String        @unique
  isAdmin          Boolean       @default(false)
  businessVerified Boolean       @default(false)
  adSlots          AdSlot[]
  // Relation avec l'abonnement
  subscription     Subscription? 
}

model Subscription {
  id               String   @id @default(cuid())
  userId           String   @unique
  user             User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  stripeCustomerId String   @unique
  stripePriceId    String
  status           String   // ex: "active", "canceled", "past_due"
  currentPeriodEnd DateTime
  updatedAt        DateTime @updatedAt
}

model AdSlot {
  id            String   @id @default(cuid())
  date          DateTime
  price         Float
  displayType   String   // Ex: "Newsletter Top", "Podcast Mid-roll", "Sidebar"
  description   String?  // Ex: "Banni√®re 600x200px en haut de la newsletter"
  isBooked      Boolean  @default(false)
  
  creatorId     String
  creator       User     @relation(fields: [creatorId], references: [id])
  booking       Booking?
}

enum BookingStatus {
  PENDING
  APPROVED
  REJECTED
  COMPLETED
}

model Booking {
  id            String        @id @default(cuid())
  createdAt     DateTime      @default(now())
  status        BookingStatus @default(PENDING)
  
  adImage       String   
  adLink        String   
  adText        String?  
  
  buyerEmail    String   
  amountPaid    Float
  
  // Statistiques pour l'annonceur
  clicks        Int      @default(0)
  impressions   Int      @default(0)
  
  slotId        String   @unique
  slot          AdSlot   @relation(fields: [slotId], references: [id])
}